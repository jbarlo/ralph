{
  "tickets": [
    {
      "id": 1,
      "title": "Create hooks.d directory structure",
      "description": "Create the hooks.d directory structure for ralph. On ralph-init, create a hooks.d/ directory in the project with subdirectories for each hook event: hooks.d/on-start/, hooks.d/on-complete/, hooks.d/on-error/. Each directory should contain a .gitkeep file to ensure it's tracked. Update ralph-init to create this structure.",
      "status": "completed",
      "priority": 10
    },
    {
      "id": 2,
      "title": "Create ralph-hooks executor script",
      "description": "Create bin/ralph-hooks script that executes all executable scripts in a given hooks.d/<event>/ directory. Usage: ralph-hooks <event> [json-payload]. The script should: 1) Find all executable files in hooks.d/<event>/, 2) Execute each in lexicographic order, 3) Pass context via stdin (JSON) and environment variables (RALPH_HOOK_EVENT=event name, RALPH_HOOK_CONTEXT=full JSON), 4) Continue on failure (log errors but don't abort), 5) Report collected errors at end. Follows hooks.d pattern from ../specs/hooks.d.md.",
      "status": "completed",
      "priority": 10
    },
    {
      "id": 3,
      "title": "Implement on-start hook in ralph/ralph-once",
      "description": "Modify bin/ralph and bin/ralph-once to call 'ralph-hooks on-start' with ticket context before starting the docker container. The JSON payload should include: {\"event\": \"start\", \"ticket\": <current-ticket-json>, \"timestamp\": <iso8601>}. Run on host (not in container) so hooks can access host tools like todo CLI. Depends on ticket #2.",
      "status": "completed",
      "priority": 10
    },
    {
      "id": 4,
      "title": "Implement on-complete hook",
      "description": "Modify bin/ralph and bin/ralph-once to call 'ralph-hooks on-complete' on host after docker exits successfully. Payload: {\"event\": \"complete\", \"ticket\": <completed-ticket-json>, \"summary\": <last-progress.txt-entry>, \"timestamp\": <iso8601>}. Must detect successful completion (check exit code and/or ticket status change) and extract the last progress.txt entry. Runs on host so hooks can access host tools. Depends on ticket #2.",
      "status": "completed",
      "priority": 10
    },
    {
      "id": 5,
      "title": "Implement on-error hook",
      "description": "Modify bin/ralph and bin/ralph-once to call 'ralph-hooks on-error' on host when docker exits non-zero or ticket completion cannot be detected. Payload: {\"event\": \"error\", \"ticket\": <ticket-json>, \"exit_code\": <code>, \"timestamp\": <iso8601>}. Runs on host so hooks can access host tools. Depends on ticket #2.",
      "status": "pending",
      "priority": 10
    },
    {
      "id": 6,
      "title": "Add example hook scripts",
      "description": "Create example hooks in hooks.d/ (not executable by default, use .example extension). Include: 1) on-complete/log-completion.sh.example - appends ticket summary to a log file, demonstrates parsing JSON payload. 2) on-error/notify.sh.example - sends desktop notification on failure (notify-send or similar). Comments in each should explain how to enable (chmod +x, rename) and how to adapt for other tools. Depends on ticket #1.",
      "status": "pending",
      "priority": 10
    },
    {
      "id": 7,
      "title": "Document hooks.d in ralph-help",
      "description": "Update bin/ralph-help to document the hooks.d system. Include: available events (on-start, on-complete, on-error), hook directory structure, payload format for each event, how to enable a hook (make executable), example use cases. Depends on tickets #1-5.",
      "status": "pending",
      "priority": 10
    },
    {
      "id": 8,
      "title": "Add ralph hooks CLI management",
      "description": "Add hooks management subcommands to ralph. Commands: 'ralph hooks list [event]' - list all hooks or hooks for specific event, 'ralph hooks add <event> <script>' - create symlink to script in hooks.d/<event>/, 'ralph hooks rm <event> <name>' - remove hook. Follows CLI management pattern from ../specs/hooks.d.md. Depends on ticket #1.",
      "status": "pending",
      "priority": 10
    },
    {
      "id": 9,
      "title": "Move ralph state to .ralph/ directory",
      "description": "Refactor to consolidate ralph state files into .ralph/ subdirectory. Move: tickets.json -> .ralph/tickets.json, progress.txt -> .ralph/progress.txt, hooks.d/ -> .ralph/hooks.d/. Keep RALPH.md at project root (visible project instructions). Update all ralph scripts to use new paths. Add fallback logic to check both locations for backwards compat. NOTE: Existing ralph projects will need manual migration - consider a ralph-migrate script or document manual steps.",
      "status": "draft",
      "priority": 20
    }
  ]
}
